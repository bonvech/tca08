1) timeout
2) проверка конца строки - конец чтения буффера произошел по концу строки или по таймауту.
3) 
